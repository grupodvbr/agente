<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agente Grupo DV</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial,sans-serif;margin:0;background:#0b1220;color:#e5e7eb}
    header{padding:16px 20px;border-bottom:1px solid #1f2937}
    main{max-width:900px;margin:24px auto;padding:0 16px}
    form{display:flex;gap:8px}
    input{flex:1;padding:12px;border-radius:10px;border:1px solid #374151;background:#111827;color:#e5e7eb}
    button{padding:12px 16px;border-radius:10px;border:0;background:#0ea5e9;color:#0b1220;font-weight:700;cursor:pointer}
    pre{white-space:pre-wrap;background:#111827;border:1px solid #374151;border-radius:12px;padding:16px;margin-top:16px}
  </style>
</head>
<body>
  <header><h1>Agente Grupo DV</h1></header>
  <main>
    <form id="chat">
      <input id="q" placeholder="Ex.: Vendas da VILLA GOURMET de 2025-08-01 a 2025-08-11" />
      <button>Enviar</button>
    </form>
    <pre id="out">Faça uma pergunta…</pre>
  </main>

  <script>
    const out = document.getElementById('out');
    const form = document.getElementById('chat');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const content = document.getElementById('q').value || "";
      out.textContent = "Consultando…";
      const r = await fetch('/api/agent', {
        method:'POST',
        headers:{'content-type':'application/json'},
        body: JSON.stringify({ messages: [{ role:"user", content }] })
      });
      const data = await r.json();
      const txt = data.output_text || JSON.stringify(data, null, 2);
      out.textContent = txt;
    });
  </script>
</body>
</html>